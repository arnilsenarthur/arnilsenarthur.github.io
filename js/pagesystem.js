let feedPosts=[],currentFeedPost=0,lastFeedScrollPos=0,homeAnimationInitialized=!1;function initializeHomeAnimation(){homeAnimationInitialized=!1;const e=document.querySelector(".landing-section");e&&e.classList.remove("animation-ready"),document.body.offsetHeight,homeAnimationInitialized=!0,e&&(e.classList.add("animation-ready"),setTimeout(()=>{window.LandingPage&&window.LandingPage.initialize()},250))}window.onhashchange=()=>{onOpenPage(window.location.hash.substring(1))},document.addEventListener("visibilitychange",()=>{document.hidden?window.destroyTimeline3D&&window.destroyTimeline3D():"#timeline"===window.location.hash&&window.ensureTimeline3D&&window.ensureTimeline3D()}),window.addEventListener("pagehide",()=>{window.destroyTimeline3D&&window.destroyTimeline3D()});let firstOpen=!0;function onOpenPage(e){function t(t){let n;$(".canvas").scrollTop(0),$(".content.current").removeClass("current"),n=""===e?$(".content").filter(function(){return""===$(this).attr("page")}):$(".content[page='"+e+"']"),n.css("opacity",0),n.addClass("current"),$(".window").css("max-height","1000px"),"timeline"!==e?window.destroyTimeline3D&&window.destroyTimeline3D():setTimeout(()=>{window.ensureTimeline3D&&window.ensureTimeline3D()},500);const i=window.location.pathname,a=i.includes("/gamedev/")||i.includes("/dev/");"post"==e?($(".menubar > .link:not(.return-feed)").addClass("force-hide"),$(".header > .link:not(.return-feed)").addClass("force-hide")):a?($(".menubar > .link:not(.return-feed)").removeClass("force-hide"),$(".header > .link:not(.return-feed)").removeClass("force-hide")):($(".menubar > .link").each(function(){const e=$(this).attr("href");"#"===e||"#contact"===e||"#timeline"===e||"/arnilsen_arthur.pdf"===e?$(this).removeClass("force-hide"):$(this).addClass("force-hide")}),$(".header > .link").each(function(){const e=$(this).attr("href");"#"===e||"#contact"===e||"#timeline"===e||"/arnilsen_arthur.pdf"===e?$(this).removeClass("force-hide"):$(this).addClass("force-hide")}));var s="game"==e||"timeline"==e;if($(".link.return").css("display",s?"block":"none"),$(".link.return-feed").css("display","post"==e?"block":"none"),s?$(".menubar").addClass("hidden"):$(".menubar").removeClass("hidden"),"game"==e?window.lazyLoadGameScripts?(window.lazyLoadGameScripts(),setTimeout(()=>{onGameOpen(),$(".menu").addClass("open"),$("#pageplay").addClass("active")},1e3)):(onGameOpen(),$(".menu").addClass("open"),$("#pageplay").addClass("active")):"undefined"!=typeof game&&null!=game&&onGameClose(),"feed"==e&&($(".menubar").removeClass("hidden"),$(".menu").addClass("open"),$.get("https://api.rss2json.com/v1/api.json?rss_url=https://medium.com/feed/@arnilsenarthur",function(e){const t=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];let n="";for(var i in e.items){let a=e.items[i],s=new Date(a.pubDate),o=a.description.replace(/(<figure>.*<\/figure>)|(<img[^>]*>)|(<figcaption>.*<\/figcaption>)/,"").replace(/<\/?[^>]+(>|$)/g,"");a.date=`${t[s.getMonth()]} ${s.getDate()}, ${s.getFullYear()}`,feedPosts.push({date:a.date,content:a.content,title:a.title}),n+=`<div class="paperitem" onclick="lastFeedScrollPos = $('#papers').scrollTop(); currentFeedPost = ${feedPosts.length-1}; onOpenPage('post');">${a.date}<br><b class="papertitle">${a.title}</b><br><div class="paperdesc">${o}</div></div><br>\n`}$("#paperscontent").html(n),$("#papers").scrollTop(lastFeedScrollPos)})),"post"==e){let e=feedPosts[currentFeedPost];$("#postcontent").scrollTop(0),$("#postcontent").html(`<br>${e.date}<h1>${e.title}</h1><div class="separator"></div>${e.content}`)}openContents(null!=t)}""!==e&&"home"!==e||setTimeout(()=>{initializeHomeAnimation()},100),$(".link").removeClass("active"),$("a[href='#"+e+"']").addClass("active"),$(".progress").removeClass("fill"),$(".progress.fill").css("width","0px"),firstOpen?t(!0):($(".window").css("max-height","30px"),closeContents(t)),firstOpen=!1}function reopenFeed(){onOpenPage("feed")}function closeContents(e){anime({targets:".content.current",opacity:[1,0],duration:500,complete:e}),anime({targets:".window",translateX:"-50%",translateY:"-50%",perspective:"800px",rotateX:-30,rotateY:20,easing:"spring(0.5, 80, 5, 0)"})}function openContents(e){anime({targets:".content.current *:not(.timeline):not(b):not(.landing-section):not(.landing-section *):not(.timeline-ui-overlay):not(.timeline-ui-overlay *):not(#timeline-canvas-container):not(#timeline-canvas-container *) , .content.current:not(.timeline):not(b)",opacity:[0,1],duration:500,delay:function(e,t,n){return $(e).hasClass("progress")&&setTimeout(()=>{$(e).css("width",""),$(e).addClass("fill")},100),n<10?100*t:n<30?50*t:2*t}}),e&&anime({targets:".window",translateX:"-50%",translateY:"-50%",perspective:"800px",rotateX:0,rotateY:0,easing:"spring(0.5, 80, 5, 0)"})}function switchToGames(){localStorage.setItem("lastPersonaPage","gamedev"),window.location.href="/gamedev/"}function switchToDevelopment(){localStorage.setItem("lastPersonaPage","dev"),window.location.href="/dev/"}function updatePersonaUI(e){const t=$(".header");"gamedev"===e?(t.addClass("game-theme"),t.removeClass("dev-theme")):(t.addClass("dev-theme"),t.removeClass("game-theme")),$(".toggle-btn").removeClass("active"),"gamedev"===e?$(".toggle-btn.game-mode").addClass("active"):$(".toggle-btn.dev-mode").addClass("active"),updateNavigationVisibility(e)}function updateNavigationVisibility(e){"gamedev"===e||"dev"===e?($(".menubar > .link:not(.return-feed)").removeClass("force-hide"),$(".header > .link:not(.return-feed)").removeClass("force-hide")):($(".menubar > .link").each(function(){const e=$(this).attr("href");"#"===e||"#contact"===e||"arnilsen_arthur.pdf"===e?$(this).removeClass("force-hide"):$(this).addClass("force-hide")}),$(".header > .link").each(function(){const e=$(this).attr("href");"#"===e||"#contact"===e||"arnilsen_arthur.pdf"===e?$(this).removeClass("force-hide"):$(this).addClass("force-hide")}))}function closeFullscreenImage(){$("#fullscreen-image-viewer").fadeOut(200)}$(document).ready(function(){$(".filter-btn").on("click",function(){!function(e){$(".filter-btn").removeClass("active"),$(`.filter-btn[data-filter="${e}"]`).addClass("active"),"all"===e?$(".project-item").removeClass("hidden"):$(".project-item").each(function(){($(this).data("tags")||"").split(",").map(e=>e.trim()).includes(e)?$(this).removeClass("hidden"):$(this).addClass("hidden")})}($(this).data("filter"))}),$(".project-image").on("click",function(){const e=$(this).attr("src"),t=$(this).attr("alt");$("#fullscreen-image").attr("src",e),$("#fullscreen-image").attr("alt",t),$("#fullscreen-image-viewer").fadeIn(200)})}),$(document).on("keydown",function(e){27===e.keyCode&&$("#fullscreen-image-viewer").is(":visible")&&closeFullscreenImage()});